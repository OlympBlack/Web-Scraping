# Projet de Scraping Web (BrainyQuote)

Une application full-stack de web scraping construite avec **Nuxt 3** (Frontend) et **FastAPI + Playwright** (Backend), intégrée avec **Supabase** pour la base de données et le stockage.

## Fonctionnalités
- **Scraping** : Extraction automatisée de citations et d'images depuis BrainyQuote.
- **Retour en temps réel** : Barre de progression et mises à jour de statut en direct via Server-Sent Events (SSE).
- **Stockage** : Les images sont téléchargées, traitées et stockées dans Supabase Storage avec les types MIME corrects.
- **Base de données** : Les citations sont sauvegardées dans une base de données Postgres Supabase.

---

## Prérequis
- **Python 3.10+**
- **Node.js 18+**
- **Compte Supabase** avec un nouveau projet.

---

## Installation et Configuration

### 1. Configuration du Backend

Naviguez dans le dossier backend :
```bash
cd backend
```

Créez un environnement virtuel et installez les dépendances :
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate

# Installer les paquets
pip install -r requirements.txt
playwright install chromium
```

Créez un fichier `.env` dans `backend/` :
```ini
SUPABASE_URL=votre_url_projet_supabase
SUPABASE_KEY=votre_cle_anon_supabase
SUPABASE_SERVICE_ROLE_KEY=votre_cle_service_role
```

### 2. Configuration du Frontend

Naviguez dans le dossier frontend :
```bash
cd ../frontend
```

Installez les dépendances :
```bash
npm install
```

### 3. Configuration de Supabase

1.  **Base de données** : Créez une table nommée `quotes`.
    ```sql
    create table quotes (
      id bigint generated by default as identity primary key,
      created_at timestamp with time zone default timezone('utc'::text, now()) not null,
      text text,
      author text,
      topic text,
      link text unique,
      image_url text
    );
    ```
2.  **Stockage** : Créez un bucket public nommé `quote-images`.

---

## Utilisation

### Lancer Localement

Vous avez besoin de deux terminaux.

**Terminal 1 : Backend**
```bash
cd backend
venv\Scripts\activate  # Windows
python run.py
```
*Le backend tourne sur http://127.0.0.1:8000*

**Terminal 2 : Frontend**
```bash
cd frontend
npm run dev
```
*Le frontend tourne sur http://localhost:3000*

**Utilisation** : Ouvrez l'URL du frontend, entrez un sujet (ex: "Success"), et cliquez sur "Scrape".

---

## Déploiement

### Frontend (Nuxt)
Déployez sur **Vercel** ou **Netlify**.
1.  Connectez votre dépôt GitHub.
2.  Commande de build : `npm run build`.
3.  Dossier de sortie : `.output`.

### Backend (FastAPI + Playwright)
Déployez sur une plateforme supportant Docker ou Python + Navigateurs Système (ex: **Railway**, **Render**, ou un **VPS**).

**Exemple de Dockerfile (pour le Backend) :**
```dockerfile
FROM mcr.microsoft.com/playwright/python:v1.40.0-jammy

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
```
